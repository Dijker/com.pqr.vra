{"version":3,"sources":["../../src/vra/approval.js"],"names":["requestPromise","promisifyAll","require","module","exports","getAllApprovalPolicies","getApprovalPolicyById","createApprovalPolicy","updateApprovalPolicy","getApprovalPolicyTypeByName","deleteApprovalPolicy","_this","resolve","reject","options","method","agent","config","url","hostname","headers","token","json","getAsync","then","response","catch","error","id","deleteAsync","policyJson","body","postAsync","putAsync","policyTypeName","policyTypes","content","i","length","policyType","name","Error"],"mappings":"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","file":"approval.js","sourcesContent":["import Promise from 'bluebird'\nvar requestPromise = Promise.promisifyAll(require('request'))\n\nmodule.exports = {\n  getAllApprovalPolicies: getAllApprovalPolicies,\n  getApprovalPolicyById: getApprovalPolicyById,\n  createApprovalPolicy: createApprovalPolicy,\n  updateApprovalPolicy: updateApprovalPolicy,\n  getApprovalPolicyTypeByName: getApprovalPolicyTypeByName,\n  deleteApprovalPolicy: deleteApprovalPolicy\n}\n\nfunction getAllApprovalPolicies () {\n  var _this = this\n\n  return new Promise(function (resolve, reject) {\n    var options\n\n    options = {\n      method: 'GET',\n      agent: _this.config.agent,\n      url: `https://${_this.config.hostname}/approval-service/api/policies?limit=1000`,\n      headers: {\n        'cache-control': 'no-cache',\n        'authorization': `Bearer ${_this.config.token}`\n      },\n      json: true\n    }\n\n    requestPromise.getAsync(options)\n      .then(function (response) {\n        return resolve(response)\n      })\n      .catch(function (error) {\n        reject(error)\n      })\n  })\n}\n\nfunction getApprovalPolicyById (id) {\n  var _this = this\n\n  return new Promise(function (resolve, reject) {\n    var options\n    options = {\n      method: 'GET',\n      agent: _this.config.agent,\n      url: `https://${_this.config.hostname}/approval-service/api/policies/${id}`,\n      headers: {\n        'cache-control': 'no-cache',\n        'authorization': `Bearer ${_this.config.token}`\n      },\n      json: true\n    }\n\n    requestPromise.getAsync(options)\n      .then(function (response) {\n        return resolve(response)\n      })\n      .catch(function (error) {\n        reject(error)\n      })\n  })\n}\n\nfunction deleteApprovalPolicy (id) {\n  var _this = this\n\n  return new Promise(function (resolve, reject) {\n    var options\n    options = {\n      method: 'DELETE',\n      agent: _this.config.agent,\n      url: `https://${_this.config.hostname}/approval-service/api/policies/${id}`,\n      headers: {\n        'cache-control': 'no-cache',\n        'authorization': `Bearer ${_this.config.token}`\n      },\n      json: true\n    }\n\n    requestPromise.deleteAsync(options)\n      .then(function (response) {\n        return resolve(response)\n      })\n      .catch(function (error) {\n        reject(error)\n      })\n  })\n}\n\nfunction createApprovalPolicy (policyJson) {\n  var _this = this\n\n  return new Promise(function (resolve, reject) {\n    var options\n    options = {\n      method: 'POST',\n      agent: _this.config.agent,\n      url: `https://${_this.config.hostname}/approval-service/api/policies`,\n      headers: {\n        'cache-control': 'no-cache',\n        'authorization': `Bearer ${_this.config.token}`\n      },\n      body: policyJson,\n      json: true\n    }\n\n    requestPromise.postAsync(options)\n      .then(function (response) {\n        return resolve(response)\n      })\n      .catch(function (error) {\n        reject(error)\n      })\n  })\n}\n\nfunction updateApprovalPolicy (id, policyJson) {\n  var _this = this\n\n  return new Promise(function (resolve, reject) {\n    var options\n    options = {\n      method: 'PUT',\n      agent: _this.config.agent,\n      url: `https://${_this.config.hostname}/approval-service/api/policies/${id}`,\n      headers: {\n        'cache-control': 'no-cache',\n        'authorization': `Bearer ${_this.config.token}`\n      },\n      body: policyJson,\n      json: true\n    }\n\n    requestPromise.putAsync(options)\n      .then(function (response) {\n        return resolve(response)\n      })\n      .catch(function (error) {\n        reject(error)\n      })\n  })\n}\n\nfunction getApprovalPolicyTypeByName (policyTypeName) {\n  var _this = this\n\n  return new Promise(function (resolve, reject) {\n    var options\n    options = {\n      method: 'GET',\n      agent: _this.config.agent,\n      url: `https://${_this.config.hostname}/approval-service/api/policytypes?limit=1000`,\n      headers: {\n        'cache-control': 'no-cache',\n        'authorization': `Bearer ${_this.config.token}`\n      },\n      json: true\n    }\n    requestPromise.getAsync(options)\n      .then(function (response) {\n        var policyTypes = response.body.content\n\n        for (var i = 0; i < policyTypes.length; i++) {\n          var policyType = policyTypes[i]\n          if (policyType.name === policyTypeName) {\n            return resolve(policyType)\n          }\n        }\n\n        reject(new Error('Could not find policyType with name' + policyTypeName))\n      })\n      .catch(function (error) {\n        reject(error)\n      })\n  })\n}\n"]}